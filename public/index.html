<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Generador IA</title>
<style>body{font-family:sans-serif;padding:20px;background:#111;color:#fff}input,textarea,select,button{width:100%;margin:.5rem 0;padding:.6rem;border-radius:4px;border:none}button{background:#0c9;color:#fff;font-weight:bold;cursor:pointer}#logs{background:#000;padding:1rem;height:200px;overflow-y:auto;white-space:pre-wrap}</style>
</head>
<body>
<h1>üé¨ Generador IA</h1>
<input id="eleven" placeholder="ElevenLabs API Key">
<input id="pexels" placeholder="Pexels API Key">
<select id="modo"><option value="video">video</option><option value="carrusel">carrusel</option></select>
<textarea id="guiones" rows="4" placeholder="Escribe cada guion en l√≠nea nueva"></textarea>
<textarea id="etiquetas" rows="4" placeholder="Etiquetas (en ingl√©s)"></textarea>
<button onclick="empezar()">üöÄ Empezar</button>
<pre id="logs">Esperando...</pre>
<button onclick="descargar()">‚¨áÔ∏è Descargar resultado</button>
<script>
async function empezar() {
  const logs = document.getElementById("logs");
  logs.innerText = "‚è≥ Generando contenido...";

  try {
    const res = await fetch("/generar", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        eleven_api: document.getElementById("eleven").value,
        pexels_api: document.getElementById("pexels").value,
        modo: document.getElementById("modo").value,
        guiones: document.getElementById("guiones").value,
        etiquetas: document.getElementById("etiquetas").value
      })
    });

    const j = await res.json();

    if (j.success) {
      logs.innerText = j.logs || "‚úÖ Proceso completado sin logs.";
    } else {
      logs.innerText = "‚ùå Error: " + (j.error || "Error desconocido del servidor");
    }

  } catch (err) {
    logs.innerText = "‚ùå Error de red: " + err.message;
  }
}

function descargar(){
  const modo = document.getElementById("modo").value;
  window.location.href = modo==='video'?'/descargar_video':'/descargar_carrusel';
}
</script>
</body>
</html>
